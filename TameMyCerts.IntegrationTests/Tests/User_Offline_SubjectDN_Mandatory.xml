<CertificateRequestPolicy xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <SubjectAlternativeName>
    <SubjectRule>
      <Field>userPrincipalName</Field>
      <Mandatory>true</Mandatory>
      <MaxOccurrences>1</MaxOccurrences>
      <MaxLength>64</MaxLength>
      <Patterns>
        <Pattern>
          <Expression>^[a-zA-Z0-9]*(\@tamemycerts-tests\.local)$</Expression>
        </Pattern>
      </Patterns>
    </SubjectRule>
  </SubjectAlternativeName>
  <DirectoryServicesMapping>
    <SubjectDistinguishedName>
      <RelativeDistinguishedName>
        <Field>emailAddress</Field>
        <DirectoryServicesAttribute>mail</DirectoryServicesAttribute>
        <Mandatory>true</Mandatory>
      </RelativeDistinguishedName>
      <RelativeDistinguishedName>
        <Field>commonName</Field>
        <DirectoryServicesAttribute>displayName</DirectoryServicesAttribute>
        <Mandatory>true</Mandatory>
      </RelativeDistinguishedName>
      <RelativeDistinguishedName>
        <Field>organizationName</Field>
        <DirectoryServicesAttribute>company</DirectoryServicesAttribute>
        <Mandatory>true</Mandatory>
      </RelativeDistinguishedName>
      <RelativeDistinguishedName>
        <Field>organizationalUnitName</Field>
        <DirectoryServicesAttribute>department</DirectoryServicesAttribute>
        <Mandatory>true</Mandatory>
      </RelativeDistinguishedName>
      <RelativeDistinguishedName>
        <Field>localityName</Field>
        <DirectoryServicesAttribute>l</DirectoryServicesAttribute>
        <Mandatory>true</Mandatory>
      </RelativeDistinguishedName>    
      <RelativeDistinguishedName>
        <Field>stateOrProvinceName</Field>
        <DirectoryServicesAttribute>st</DirectoryServicesAttribute>
        <Mandatory>true</Mandatory>
      </RelativeDistinguishedName>
      <RelativeDistinguishedName>
        <Field>countryName</Field>
        <DirectoryServicesAttribute>c</DirectoryServicesAttribute>
        <Mandatory>true</Mandatory>
      </RelativeDistinguishedName>
      <RelativeDistinguishedName>
        <Field>title</Field>
        <DirectoryServicesAttribute>title</DirectoryServicesAttribute>
        <Mandatory>true</Mandatory>
      </RelativeDistinguishedName>    
      <RelativeDistinguishedName>
        <Field>givenName</Field>
        <DirectoryServicesAttribute>givenName</DirectoryServicesAttribute>
        <Mandatory>true</Mandatory>
      </RelativeDistinguishedName>
      <RelativeDistinguishedName>
        <Field>initials</Field>
        <DirectoryServicesAttribute>initials</DirectoryServicesAttribute>
        <Mandatory>true</Mandatory>
      </RelativeDistinguishedName>    
      <RelativeDistinguishedName>
        <Field>surname</Field>
        <DirectoryServicesAttribute>sn</DirectoryServicesAttribute>
        <Mandatory>true</Mandatory>
      </RelativeDistinguishedName>
      <RelativeDistinguishedName>
        <Field>streetAddress</Field>
        <DirectoryServicesAttribute>streetAddress</DirectoryServicesAttribute>
        <Mandatory>true</Mandatory>
      </RelativeDistinguishedName>
    </SubjectDistinguishedName>
  </DirectoryServicesMapping>
</CertificateRequestPolicy>