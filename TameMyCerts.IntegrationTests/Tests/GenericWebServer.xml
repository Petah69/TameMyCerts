<CertificateRequestPolicy xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <KeyAlgorithm>RSA</KeyAlgorithm>
  <MinimumKeyLength>2048</MinimumKeyLength>
  <MaximumKeyLength>3072</MaximumKeyLength>
  <Subject>
    <SubjectRule>
      <Field>commonName</Field>
      <Mandatory>true</Mandatory>
      <MaxOccurrences>3</MaxOccurrences>
      <MaxLength>64</MaxLength>
      <Patterns>
        <Pattern>
          <Expression>^[-_a-zA-Z0-9]*(\.intra)?(\.tamemycerts-tests\.local)$</Expression>
        </Pattern>
        <Pattern>
          <Expression>192.168.0.0/24</Expression>
          <TreatAs>Cidr</TreatAs>
        </Pattern>
        <Pattern><!-- note that this only works for substitution as of version 1.4 -->
          <Expression>0000:0000:0000:0000:0000:0000:0000:0000/128</Expression>
          <TreatAs>Cidr</TreatAs>
        </Pattern>
        <Pattern>
          <Expression>^.*(porn|gambling).*$</Expression>
          <Action>Deny</Action>
        </Pattern>
        <Pattern>
          <Expression>^intra\.adcslabor\.de$</Expression>
          <Action>Deny</Action>
        </Pattern>
      </Patterns>
    </SubjectRule>
    <SubjectRule>
      <Field>countryName</Field>
      <Mandatory>false</Mandatory>
      <MaxOccurrences>1</MaxOccurrences>
      <MaxLength>2</MaxLength>
      <Patterns>
        <Pattern>
          <Expression>^(DE|US)$</Expression>
        </Pattern>
      </Patterns>
    </SubjectRule>
    <SubjectRule>
      <Field>organizationName</Field>
      <Mandatory>false</Mandatory>
      <MaxOccurrences>1</MaxOccurrences>
      <MaxLength>32</MaxLength>
      <Patterns>
        <Pattern>
          <Expression>^(ADCS Labor)$</Expression>
        </Pattern>
      </Patterns>
    </SubjectRule>
    <SubjectRule>
      <Field>organizationalUnitName</Field>
      <Mandatory>false</Mandatory>
      <MaxOccurrences>1</MaxOccurrences>
      <MaxLength>32</MaxLength>
      <Patterns>
        <Pattern>
          <Expression>^.*$</Expression>
        </Pattern>
      </Patterns>
    </SubjectRule>
    <SubjectRule>
      <Field>localityName</Field>
      <Mandatory>false</Mandatory>
      <MaxOccurrences>1</MaxOccurrences>
      <MaxLength>32</MaxLength>
      <Patterns>
        <Pattern>
          <Expression>^(Munich)$</Expression>
        </Pattern>
      </Patterns>
    </SubjectRule>
  </Subject>
  <SubjectAlternativeName>
    <SubjectRule>
      <Field>dNSName</Field>
      <Mandatory>false</Mandatory>
      <MaxOccurrences>10</MaxOccurrences>
      <MaxLength>64</MaxLength>
      <Patterns>
        <Pattern>
          <Expression>^[-_a-zA-Z0-9]*(\.intra)?(\.tamemycerts-tests\.local)$</Expression>
        </Pattern>
        <Pattern>
          <Expression>^.*(porn|gambling).*$</Expression>
          <Action>Deny</Action>
        </Pattern>
        <Pattern>
          <Expression>^intra\.adcslabor\.de$</Expression>
          <Action>Deny</Action>
        </Pattern>
      </Patterns>
    </SubjectRule>
    <SubjectRule>
      <Field>iPAddress</Field>
      <Mandatory>false</Mandatory>
      <MaxOccurrences>10</MaxOccurrences>
      <MaxLength>64</MaxLength>
      <Patterns>
        <Pattern>
          <Expression>192.168.101.0/24</Expression>
          <TreatAs>Cidr</TreatAs>
        </Pattern>
      </Patterns>
    </SubjectRule>
  </SubjectAlternativeName>
  <SupplementDnsNames>true</SupplementDnsNames>
</CertificateRequestPolicy>